function Tracker(m){var e=this;var p=0;var a;var f=null;var n=0;var g=parseInt(m.getDuration(),10);var g=0;var i=0;var r=[];var h=false;m.bindEvent("open_state_change",l);m.bindEvent("play_state_change",q);m.bindEvent("position_change2",c);m.bindEvent("position_change",d);function d(s){}function l(s){if(s==OpenState.OPENED){i=parseInt(m.getCurrentPosition(),10);g=parseInt(m.getDuration(),10)}}function q(s){switch(s){case PlayState.PLAYING:k();break;case PlayState.PAUSED:j();break;case PlayState.STOPPED:if(!h){c(i,n)}i=0;h=false;j();break;case PlayState.BUFFERING_STARTED:j();break;case PlayState.COMPLETE:c(i,g);h=true;setTimeout(function(){b(new Date().getTime(),g)},100);break}}function c(s,t){if(t<i){t=i}r.push([i,parseInt(t,10)]);i=parseInt(s)}function o(t,u){var s;u=u||[];for(s in t){if(t.hasOwnProperty(s)){u[s]=t[s]}}return u}this.getHistory=function(){var x=o(r);var w=m.getPlayState();if(w!=PlayState.STOPPED&&w!=PlayState.COMPLETE){var t=parseInt(m.getCurrentPosition(),10);if(t<i){t=i}x.push([i,t])}var s=[];var v=x.length;for(var u=0;u<v;u+=1){s.push([x[u][0],x[u][1]].join(":"))}return s.join(",")};this.setHistory=function(v){var s=v.replace(/:/g,",").split(",");var u=s.length;for(var t=0;t<u;t+=2){r.push([s[t],s[t+1]])}};this.getPercent=function(){var z=o(r);var t=m.getPlayState();if(t!=PlayState.STOPPED&&t!=PlayState.COMPLETE){var x=parseInt(m.getCurrentPosition(),10);if(x<i){x=i}z.push([i,x])}z.sort(function(E,D){return E[0]-D[0]});var B,C,u,w,s;B=0,C=0,u=0,w=0,s=0;var v=z.length;if(v>0){C=Number(z[0][0],10);u=Number(z[0][1],10);for(var y=1;y<v;y+=1){w=Number(z[y][0],10);s=Number(z[y][1],10);if(s!=w){var A=u;if(A>w){u=w}if(A>s){s=A}if(u-C>0){B+=(u-C)}C=w;u=s}}}if(u-C>0){B+=(u-C)}return parseInt(B/g*100,10)};this.getTracker=function(){var D=[];var y=o(r);var s=m.getPlayState();if(s!=PlayState.STOPPED&&s!=PlayState.COMPLETE){var w=parseInt(m.getCurrentPosition(),10);if(w<i){w=i}y.push([i,w])}y.sort(function(F,E){return F[0]-E[0]});var B,u,C,t,A;B=0,u=0,C=0,t=0,A=0;var v=y.length;if(v>0){u=Number(y[0][0],10);C=Number(y[0][1],10);for(var x=1;x<v;x+=1){t=Number(y[x][0],10);A=Number(y[x][1],10);if(t!=A){var z=C;if(z>t&&z<A){C=A}if(z<t){D.push([u,C].join(":"));u=t;C=A}}}D.push([u,C].join(":"))}return D.join(",")};this.getPlayTime=function(){return parseInt(p,10)};function k(){a=new Date().getTime();if(f==null){f=setInterval(function(){b(new Date().getTime(),parseInt(m.getCurrentPosition(),10))},1000)}}function j(){clearInterval(f);f=null}function b(u,v){if(v>0){n=parseInt(v,10)}var t=new Number(m.getRate());var s=u-a;p+=s*t.toFixed(1)/1000;a=u;$("#debug2").text("History : "+e.getHistory());$("#debug3").text("Tracker : "+e.getTracker())}};